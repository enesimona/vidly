(this.webpackJsonpvidly=this.webpackJsonpvidly||[]).push([[0],{32:function(e,a,t){},40:function(e,a,t){e.exports=t(64)},45:function(e,a,t){},64:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(35),c=t.n(l),o=(t(45),t(2)),i=(t(32),[{_id:"5b21ca3eeb7f6fbccd471818",name:"Action"},{_id:"5b21ca3eeb7f6fbccd471814",name:"Comedy"},{_id:"5b21ca3eeb7f6fbccd471820",name:"Thriller"}]);function m(){return i.filter((function(e){return e}))}var u=[{_id:"5b21ca3eeb7f6fbccd471815",title:"Terminator",genre:{_id:"5b21ca3eeb7f6fbccd471818",name:"Action"},numberInStock:6,dailyRentalRate:2.5,publishDate:"2018-01-03T19:04:28.809Z",liked:!0},{_id:"5b21ca3eeb7f6fbccd471816",title:"Die Hard",genre:{_id:"5b21ca3eeb7f6fbccd471818",name:"Action"},numberInStock:5,dailyRentalRate:2.5},{_id:"5b21ca3eeb7f6fbccd471817",title:"Get Out",genre:{_id:"5b21ca3eeb7f6fbccd471820",name:"Thriller"},numberInStock:8,dailyRentalRate:3.5},{_id:"5b21ca3eeb7f6fbccd471819",title:"Trip to Italy",genre:{_id:"5b21ca3eeb7f6fbccd471814",name:"Comedy"},numberInStock:7,dailyRentalRate:3.5},{_id:"5b21ca3eeb7f6fbccd47181a",title:"Airplane",genre:{_id:"5b21ca3eeb7f6fbccd471814",name:"Comedy"},numberInStock:7,dailyRentalRate:3.5},{_id:"5b21ca3eeb7f6fbccd47181b",title:"Wedding Crashers",genre:{_id:"5b21ca3eeb7f6fbccd471814",name:"Comedy"},numberInStock:7,dailyRentalRate:3.5},{_id:"5b21ca3eeb7f6fbccd47181e",title:"Gone Girl",genre:{_id:"5b21ca3eeb7f6fbccd471820",name:"Thriller"},numberInStock:7,dailyRentalRate:4.5},{_id:"5b21ca3eeb7f6fbccd47181f",title:"The Sixth Sense",genre:{_id:"5b21ca3eeb7f6fbccd471820",name:"Thriller"},numberInStock:4,dailyRentalRate:3.5},{_id:"5b21ca3eeb7f6fbccd471821",title:"The Avengers",genre:{_id:"5b21ca3eeb7f6fbccd471818",name:"Action"},numberInStock:7,dailyRentalRate:3.5}];function s(){return u}function d(e){var a=u.find((function(a){return a._id===e._id}))||{};return a.title=e.title,a.genre=i.find((function(a){return a.name===e.genreName})),a.numberInStock=e.numberInStock,a.dailyRentalRate=e.dailyRentalRate,a._id||(a._id=Date.now().toString(),u.push(a)),a}var b=t(15),f=t.n(b),v=function(e){var a=e.itemsCount,t=e.pageSize,n=e.currentPage,l=e.onPageChange,c=Math.ceil(a/t);if(1===c)return null;var o=f.a.range(1,c+1);return r.a.createElement("nav",null,r.a.createElement("ul",{className:"pagination"},o.map((function(e){return r.a.createElement("li",{key:e,className:e===n?"page-item active":"page-item"},r.a.createElement("a",{href:"",className:"page-link",onClick:function(a){return l(e,a)}},e))}))))};var g=function(e){var a=e.items,t=e.textProperty,n=e.valueProperty,l=e.onItemSelect,c=e.selectedItem;return r.a.createElement("ul",{className:"list-group"},a.map((function(e){return r.a.createElement("li",{onClick:function(){return l(e)},key:e[n],className:e===c?"list-group-item active":"list-group-item"},e[t])})))};g.defaultProps={textProperty:"name",valueProperty:"_id"};var p=g,h=function(e){var a="fa fa-heart";return e.liked||(a+="-o"),r.a.createElement("i",{onClick:e.onClick,style:{cursor:"pointer"},className:a,"aria-hidden":"true"})},E=t(7),y=function(e){return r.a.createElement("thead",null,r.a.createElement("tr",null,e.columns.map((function(a){return r.a.createElement("th",{className:"clickable",key:a.path||a.key,onClick:function(){return function(a){var t=Object(E.a)({},e.sortColumn);t.path===a?t.order="asc"===t.order?"desc":"asc":(t.path=a,t.order="asc"),e.onSort(t)}(a.path)}},a.label," ",function(a){var t=e.sortColumn;return a.path!==t.path?null:"asc"===t.order?r.a.createElement("i",{className:"fa fa-sort-asc"}):r.a.createElement("i",{className:"fa fa-sort-desc"})}(a))}))))},k=function(e){var a=function(e,a){return e._id+(a.path||a.key)},t=e.data,n=e.columns;return r.a.createElement("tbody",null,t.map((function(e){return r.a.createElement("tr",{key:e._id},n.map((function(t){return r.a.createElement("td",{key:a(e,t)},function(e,a){return a.content?a.content(e):f.a.get(e,a.path)}(e,t))})))})))},O=function(e){var a=e.columns,t=e.onSort,n=e.sortColumn,l=e.data;return r.a.createElement("table",{className:"table"},r.a.createElement(y,{columns:a,sortColumn:n,onSort:t}),r.a.createElement(k,{data:l,columns:a}))},j=t(5),S=function(e){var a=e.movies,t=e.onSort,n=e.sortColumn,l=[{path:"title",label:"Title",content:function(e){return r.a.createElement(j.b,{to:"/movies/".concat(e._id)},e.title)}},{path:"genre.name",label:"Genre"},{path:"numberInStock",label:"Stock"},{path:"dailyRentalRate",label:"Rate"},{key:"like",content:function(a){return r.a.createElement(h,{liked:a.liked,onClick:function(){return e.onLike(a)}})}},{key:"delete",content:function(a){return r.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:function(){return e.onDelete(a)}},"Delete")}}];return r.a.createElement(O,{columns:l,data:a,sortColumn:n,onSort:t})},N=t(39),w=function(e){var a=e.value,t=e.onChange;return r.a.createElement("input",{type:"text",name:"query",className:"form-control my-3",placeholder:"Search...",value:a,onChange:function(e){return t(e.currentTarget.value)}})},R=function(e){var a,t=Object(n.useState)([]),l=Object(o.a)(t,2),c=l[0],i=l[1],u=Object(n.useState)(4),d=Object(o.a)(u,2),b=d[0],g=(d[1],Object(n.useState)(1)),h=Object(o.a)(g,2),y=h[0],k=h[1],O=Object(n.useState)([]),R=Object(o.a)(O,2),I=R[0],C=R[1],_=Object(n.useState)(null),x=Object(o.a)(_,2),T=x[0],P=x[1],A=Object(n.useState)({path:"title",order:"asc"}),D=Object(o.a)(A,2),L=D[0],q=D[1],M=Object(n.useState)(""),G=Object(o.a)(M,2),F=G[0],W=G[1];Object(n.useEffect)((function(){i(s);var e=m(),a=[{_id:"",name:"All Genres"}].concat(e);C(a)}),[]);var B=c;F?B=c.filter((function(e){return e.title.toLowerCase().startsWith(F.toLowerCase())})):T&&T._id&&(B=c.filter((function(e){return e.genre._id===T._id}))),a=function(e,a,t){var n=(a-1)*t;return f()(e).slice(n).take(t).value()}(f.a.orderBy(B,[L.path],[L.order]),y,b);return r.a.createElement("div",{className:"starter-template"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-3"},r.a.createElement(p,{items:I,onItemSelect:function(e){P(e),k(1),W("")},selectedItem:T})),r.a.createElement("div",{className:"col"},e.user&&r.a.createElement(j.b,{to:"/movies/new",className:"btn btn-primary",style:{margin:"0 0 15px 0"}},"New Movie"),r.a.createElement("h5",null,0===c.length?"There are no more films in db.":"Showing ".concat(B.length," movies in the database")),r.a.createElement(w,{value:F,onChange:function(e){W(e),P(null),k(1)}}),r.a.createElement(S,{movies:a,onLike:function(e){var a=Object(N.a)(c),t=a.indexOf(e);a[t]=Object(E.a)({},a[t]),a[t].liked=!a[t].liked,i(a)},onDelete:function(e){var a=c.filter((function(a){return a._id!==e._id}));i(a)},onSort:function(e){q(e)},sortColumn:L}),r.a.createElement(v,{itemsCount:B.length,pageSize:b,onPageChange:function(e,a){a.preventDefault(),k(e)},currentPage:y}))))},I=t(6),C=function(){return r.a.createElement("h1",null,"Customers")},_=function(){return r.a.createElement("h1",null,"Rentals")},x=function(){return r.a.createElement("h1",null,"Page not found!")},T=function(e){return r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},r.a.createElement(j.b,{className:"navbar-brand",to:"/"},"Vidly"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"navbar-nav collapse navbar-collapse",id:"navbarNav"},r.a.createElement(j.c,{className:"nav-item nav-link",to:"/movies"},"Movies"),r.a.createElement(j.c,{className:"nav-item nav-link",to:"/customers"},"Customers"),r.a.createElement(j.c,{className:"nav-item nav-link",to:"/rentals"},"Rentals"),!e.user&&r.a.createElement(r.a.Fragment,null,r.a.createElement(j.c,{className:"nav-item nav-link",to:"/login"},"Login"),r.a.createElement(j.c,{className:"nav-item nav-link",to:"/register"},"Register")),e.user&&r.a.createElement(r.a.Fragment,null,r.a.createElement(j.c,{className:"nav-item nav-link",to:"/logout"},"Logout"))))},P=t(9),A=t(16),D=t(27),L=function(e){var a=e.name,t=e.label,n=e.err,l=Object(D.a)(e,["name","label","err"]);return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:a},t),r.a.createElement("input",Object.assign({},l,{id:"username",name:a,className:"form-control"})),n&&r.a.createElement("div",{className:"alert alert-danger"},n))},q=t(3),M=t.n(q),G=function(e){var a=e.match,t=e.history,l=Object(n.useState)([]),c=Object(o.a)(l,2),i=c[0],s=c[1],b=Object(n.useState)({title:"",genreName:"",numberInStock:0,dailyRentalRate:0}),f=Object(o.a)(b,2),v=f[0],g=f[1],p=Object(n.useState)({title:"",genreName:"",numberInStock:"",dailyRentalRate:""}),h=Object(o.a)(p,2),y=h[0],k=h[1],O={_id:M.a.string(),title:M.a.string().required().label("Title"),genreName:M.a.string().required().label("Genre"),numberInStock:M.a.number().required().min(0).max(100).label("Number in Stock"),dailyRentalRate:M.a.number().required().min(0).max(10).label("Rate")},j=a.params.id;Object(n.useEffect)((function(){var e=m();if(s(e),"new"!==j){var a,n=(a=j,u.find((function(e){return e._id===a})));if(!n)return t.replace("/not-found");g(S(n))}}),[]);var S=function(e){return{_id:e._id,title:e.title,genreName:e.genre.name,numberInStock:e.numberInStock,dailyRentalRate:e.dailyRentalRate}},N=function(){var e=M.a.validate(v,O,{abortEarly:!1}).error;if(!e)return null;var a,t={},n=Object(A.a)(e.details);try{for(n.s();!(a=n.n()).done;){var r=a.value;t[r.path[0]]=r.message}}catch(l){n.e(l)}finally{n.f()}return t},w=function(e){var a=Object(E.a)({},y),t=R(e.target);t?a[e.target.name]=t:delete a[e.target.name];var n=e.target,r=n.name,l=n.value;g(Object(E.a)(Object(E.a)({},v),{},Object(P.a)({},r,l))),console.log("MOVIE "+v),k(a)},R=function(e){var a=e.name,t=e.value,n=Object(P.a)({},a,t),r=Object(P.a)({},a,O[a]);console.log("Schema n",r);var l=M.a.validate(n,r).error;return l?l.details[0].message:null},I=function(){d(v),t.push("/movies")};return r.a.createElement("div",null,r.a.createElement("h1",null,"Movie form"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a=N();k(null!==a?a:{}),I()}},r.a.createElement(L,{type:"text",name:"title",value:v.title,label:"Title",onChange:w,err:y.title}),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Genre"),r.a.createElement("select",{className:"form-control",value:v.genreName,name:"genreName",label:"Genre",onChange:w,err:y.genreId},i.map((function(e){return r.a.createElement("option",null,e.name)})))),r.a.createElement(L,{type:"number",name:"numberInStock",value:v.numberInStock,label:"Number in Stock",onChange:w,err:y.numberInStock}),r.a.createElement(L,{type:"number",name:"dailyRentalRate",value:v.dailyRentalRate,label:"Rate",onChange:w,err:y.dailyRentalRate}),r.a.createElement("button",{disabled:N(),className:"btn btn-primary"},"new"===j?"Add Movie":"Edit Movie")))},F=t(21),W=t.n(F),B=t(26),H=t(37),z=t.n(H).a.initializeApp({apiKey:"AIzaSyD5sDFkWdHMnmHbuB_ZKthF4CcZvBIFpHk",authDomain:"vidly-d52f3.firebaseapp.com",databaseURL:"https://vidly-d52f3.firebaseio.com",projectId:"vidly-d52f3",storageBucket:"vidly-d52f3.appspot.com",messagingSenderId:"107709914335",appId:"1:107709914335:web:051f1fbe153ffa722a1d6a"}),K=function(e){var a=Object(n.useState)({email:"",password:""}),t=Object(o.a)(a,2),l=t[0],c=t[1],i=Object(n.useState)({email:"",password:""}),m=Object(o.a)(i,2),u=m[0],s=m[1],d={email:M.a.string().required().label("Email"),password:M.a.string().required().label("Password")},b=function(){var e=M.a.validate(l,d,{abortEarly:!1}).error;if(!e)return null;var a,t={},n=Object(A.a)(e.details);try{for(n.s();!(a=n.n()).done;){var r=a.value;t[r.path[0]]=r.message}}catch(c){n.e(c)}finally{n.f()}return t},f=function(){var a=Object(B.a)(W.a.mark((function a(){return W.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:z.auth().signInWithEmailAndPassword(l.email,l.password).then((function(){console.log("Login OK"),z.auth().currentUser.getIdToken(!0).then((function(a){localStorage.setItem("token",a);var t=e.location;window.location=t.from&&t.from.pathname?t.from.pathname:"/"})).catch((function(e){}))})).catch((function(e){switch(e.code){case"auth/invalid-email":case"auth/user-disabled":case"auth/user-not-found":s({email:e.message});break;case"auth/wrong-password":s({password:e.message})}}));case 1:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),v=function(e){var a=Object(E.a)({},u),t=function(e){var a=e.name,t=e.value,n=Object(P.a)({},a,t),r=Object(P.a)({},a,d[a]),l=M.a.validate(n,r).error;return l?l.details[0].message:null}(e.target);t?a[e.target.name]=t:delete a[e.target.name];var n=e.target,r=n.name,o=n.value;c(Object(E.a)(Object(E.a)({},l),{},Object(P.a)({},r,o))),s(a)};return r.a.createElement("div",null,r.a.createElement("h1",null,"Login"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a=b();s(null!==a?a:{}),f()}},r.a.createElement(L,{type:"text",name:"email",value:l.email,label:"Email",onChange:v,err:u.email}),r.a.createElement(L,{type:"password",name:"password",value:l.password,label:"Password",onChange:v,err:u.password}),r.a.createElement("button",{disabled:b(),className:"btn btn-primary"},"Login")),r.a.createElement("p",{className:"text-center my-3"},"Don't have an account?"," ",r.a.createElement(j.b,{to:"register",className:"text-blue-500 hover:text-blue-600"},"Register here")," ",r.a.createElement("br",null)," ",r.a.createElement(j.b,{to:"password-reset",className:"text-blue-500 hover:text-blue-600"},"Forgot Password?")))},U=function(e){var a=Object(n.useState)({email:"",password:""}),t=Object(o.a)(a,2),l=t[0],c=t[1],i=Object(n.useState)({email:"",password:""}),m=Object(o.a)(i,2),u=m[0],s=m[1],d={email:M.a.string().required().email().label("Email"),password:M.a.string().min(5).max(15).required()},b=function(){var e=M.a.validate(l,d,{abortEarly:!1}).error;if(!e)return null;var a,t={},n=Object(A.a)(e.details);try{for(n.s();!(a=n.n()).done;){var r=a.value;return"email"===r.path[0]||"password"===r.path[0]?(t[r.path[0]]=r.message,t):null}}catch(c){n.e(c)}finally{n.f()}},f=function(){z.auth().createUserWithEmailAndPassword(l.email,l.password).then((function(){console.log("Register OK"),z.auth().currentUser.getIdToken(!0).then((function(e){console.log(e),localStorage.setItem("token",e),window.location="/"})).catch((function(e){}))})).catch((function(e){switch(console.log("Error register "),e.code){case"auth/email-already-in-use":case"auth/invalid-email":s({email:e.message});break;case"auth/weak-password":s(e.message)}}))};Object(n.useEffect)((function(){z.auth().onAuthStateChanged((function(e){c(l?e:{})}))}),[]);var v=function(e){var a=Object(E.a)({},u),t=function(e){var a=e.name,t=e.value,n=Object(P.a)({},a,t),r=Object(P.a)({},a,d[a]),l=M.a.validate(n,r).error;return l?l.details[0].message:null}(e.target);t?a[e.target.name]=t:delete a[e.target.name];var n=e.target,r=n.name,o=n.value;c(Object(E.a)(Object(E.a)({},l),{},Object(P.a)({},r,o))),s(a)};return r.a.createElement("div",null,r.a.createElement("h1",null,"Register"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),console.log("Handle Submit");var a=b();s({errors:a||{}}),a||f()}},r.a.createElement(L,{type:"email",name:"email",label:"Email",onChange:v,err:u.email}),r.a.createElement(L,{type:"password",name:"password",label:"Password",onChange:v,err:u.password}),r.a.createElement("button",{disabled:b(),className:"btn btn-primary"},"Register")))},Z=function(e){return z.auth().signOut().then((function(){localStorage.removeItem("token"),window.location="/"})).catch((function(e){console.log(e)})),r.a.createElement("div",null)},J=function(){var e=Object(n.useState)(""),a=Object(o.a)(e,2),t=a[0],l=a[1],c=Object(n.useState)(!1),i=Object(o.a)(c,2),m=i[0],u=(i[1],Object(n.useState)(null)),s=Object(o.a)(u,2),d=s[0];s[1];return r.a.createElement("div",{className:""},r.a.createElement("h1",{className:""},"Reset your Password"),r.a.createElement("div",{className:""},r.a.createElement("form",{action:""},m&&r.a.createElement("div",{className:""},"An email has been sent to you!"),null!==d&&r.a.createElement("div",{className:""},d),r.a.createElement(L,{label:"Email",type:"email",name:"userEmail",id:"userEmail",value:t,placeholder:"Add your email",onChange:function(e){var a=e.currentTarget,t=a.name,n=a.value;"userEmail"===t&&l(n)}}),r.a.createElement("button",{className:"btn btn-primary"},"Send me a reset link")),r.a.createElement(j.b,{to:"/login",className:""},"\u2190 back to login page")))},V=t(38),$=function(e){e.path;var a=e.component,t=(e.render,e.user,e.isLoggedIn,Object(D.a)(e,["path","component","render","user","isLoggedIn"]));return r.a.createElement(I.b,Object.assign({},t,{render:function(e){return localStorage.getItem("token")?r.a.createElement(a,e):r.a.createElement(I.a,{to:{pathname:"/login",from:e.location}})}}))};var Q=function(){var e=Object(n.useState)(null),a=Object(o.a)(e,2),t=a[0],l=a[1];return Object(n.useEffect)((function(){try{var e=localStorage.getItem("token"),a=Object(V.a)(e);l(a),console.log(a)}catch(t){console.log(t)}}),[]),r.a.createElement("div",null,r.a.createElement(T,{user:t}),r.a.createElement("main",{className:"container"},r.a.createElement(I.d,null,r.a.createElement(I.b,{path:"/login",component:K}),r.a.createElement(I.b,{path:"/register",component:U}),r.a.createElement(I.b,{path:"/logout",component:Z}),r.a.createElement($,{path:"/movies/:id",component:G,user:t}),r.a.createElement(I.b,{path:"/movies",render:function(e){return r.a.createElement(R,Object.assign({},e,{user:t}))}}),r.a.createElement(I.b,{path:"/customers",component:C}),r.a.createElement(I.b,{path:"/rentals",component:_}),r.a.createElement(I.b,{path:"/not-found",component:x}),r.a.createElement(I.b,{path:"/password-reset",component:J}),r.a.createElement(I.a,{from:"/",exact:!0,to:"/movies"}),r.a.createElement(I.a,{to:"/not-found"}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(62),t(63);c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(j.a,{basename:"/vidly"},r.a.createElement(Q,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[40,1,2]]]);
//# sourceMappingURL=main.19358d72.chunk.js.map